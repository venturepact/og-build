"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require('@angular/core');
var index_1 = require('../../../shared/services/index');
var index_2 = require('../pipes/index');
var env_config_1 = require('../../../config/env.config');
var PreviewComponent = (function () {
    function PreviewComponent(subDomainService, cdr) {
        this.subDomainService = subDomainService;
        this.cdr = cdr;
        this.className = 'desktop';
    }
    PreviewComponent.prototype.ngOnInit = function () {
        this.src = env_config_1.Config.PROTOCOL + this.subDomainService.subDomain.sub_domain + '.' + env_config_1.Config.APP_EXTENSION + '/preview/previewFrame';
        var template = localStorage.getItem('template');
        if (template || this.json) {
            var app = this.json || JSON.parse(template);
            jQuery('meta[name=description]').attr('content', app.description);
            document.title = app.title;
            jQuery('#favicon').attr('href', app.favicon);
        }
    };
    PreviewComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.viewOnWindowWidthBasis();
        jQuery(window).resize(function () {
            _this.viewOnWindowWidthBasis();
        });
    };
    PreviewComponent.prototype.viewOnWindowWidthBasis = function () {
        var width = jQuery(window).width();
        if (width > 775)
            this.switchView('desktop');
        else if (width <= 775 && width > 375)
            this.switchView('tablet');
        else
            this.switchView('mobile');
        this.cdr.detectChanges();
    };
    PreviewComponent.prototype.onMouseEnter = function () {
        if (this.className === 'mobile')
            jQuery('.responsive-menu').fadeIn(600);
    };
    PreviewComponent.prototype.onMouseLeave = function () {
        if (this.className === 'mobile')
            jQuery('.responsive-menu').fadeOut(600);
    };
    PreviewComponent.prototype.switchView = function (className) {
        this.className = className;
        var width = 600;
        var height = 400;
        window.resizeBy(width, height);
        window.moveTo(((screen.width - width) / 2), ((screen.height - height) / 2));
    };
    __decorate([
        core_1.Input(), 
        __metadata('design:type', Object)
    ], PreviewComponent.prototype, "json", void 0);
    PreviewComponent = __decorate([
        core_1.Component({
            selector: 'og-preview',
            directives: [],
            providers: [],
            pipes: [index_2.SafeUrl],
            template: "\n    <div class=\"responsive-menu\" (mouseenter)=\"onMouseEnter()\">\n        <span class=\"title\">Resize Template: </span>\n        <div class=\"icon-block\">\n            <a href=\"javascript:void(0);\" (click)=\"switchView('desktop')\" [class.active-view] = \"className==='desktop'\">\n                <i class=\"material-icons\">desktop_mac</i> <span>|</span></a>\n            <a href=\"javascript:void(0);\" (click)=\"switchView('tablet')\"  [class.active-view] = \"className==='tablet'\">\n                <i class=\"material-icons\">tablet_mac</i><span>|</span> </a>\n            <a href=\"javascript:void(0);\" (click)=\"switchView('mobile')\"  [class.active-view] = \"className==='mobile'\">\n                <i class=\"material-icons\">smartphone</i></a>\n        </div>\n    </div>\n    <div id=\"main-profile\">\n        <iframe\n        (mouseenter)=\"onMouseEnter()\" \n        (mouseleave)=\"onMouseLeave()\"\n        id=\"mobile-iframe\"\n        [ngClass]=\"{\n            desktop: className==='desktop', \n            tablet: className==='tablet',\n            mobile: className==='mobile'\n        }\" \n        [src]=\"src | safeUrl\" align=\"middle\">\n        </iframe>\n    </div>",
            styles: ["\n    .responsive-menu {\n        background: rgba(0, 0, 0, 0.45);\n        color: #fff;\n        width: 320px;\n        text-align: center;\n        padding: 6px 6px;\n        position: absolute;\n        z-index: 999;\n        margin: 0 auto;\n        margin-left: auto;\n        margin-right: auto;\n        left: -3px;\n        right: 0;\n        top: 10px;\n        font-size: 13px;\n    }\n\n    .responsive-menu a {\n        color: #fff;\n        padding: 0 5px;\n            float: left;\n    }\n\n    .responsive-menu a span {\n        margin-top: -20px;\n        margin-left: 13px;\n        float: right;\n        margin-top: 3px;\n        color: rgba(255, 255, 255, 0.31);\n    }\n\n    iframe {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        margin-left: auto;\n        margin-right: auto;\n        left: 0;\n        right: 0;\n        top: 0px;\n        border: none;\n    }\n    .active-view i{\n        color: #fb545b;\n    }\n    .responsive-menu span.title {\n        margin-right: 26px;\n        float: left;\n        margin-top: 7px;\n        margin-left: 26px;\n    }\n\n    .responsive-menu div {\n        float: left;\n        margin-top: 4px;\n    }\n\n    .desktop {\n        width: 100%;\n        height: 100%;\n    }\n\n    .mobile {\n        width: 375px;\n        height: 570px;\n        margin: 1% auto;\n        height:570px;\n        border: 1px solid #dcdddf;\n    }\n\n    .tablet {\n        width: 775px;\n        height: 100%;\n        margin: 0 auto;\n        border: 1px solid #dcdddf;\n    }\n"]
        }), 
        __metadata('design:paramtypes', [index_1.SubDomainService, core_1.ChangeDetectorRef])
    ], PreviewComponent);
    return PreviewComponent;
}());
exports.PreviewComponent = PreviewComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaXRlL3RlbXBsYXRlcy90ZW1wbGF0ZUFsbC9wcmV2aWV3LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEscUJBQXlFLGVBQWUsQ0FBQyxDQUFBO0FBQ3pGLHNCQUFpQyxnQ0FBZ0MsQ0FBQyxDQUFBO0FBQ2xFLHNCQUF3QixnQkFBZ0IsQ0FBQyxDQUFBO0FBQ3pDLDJCQUF1Qiw0QkFBNEIsQ0FBQyxDQUFBO0FBb0hwRDtJQUlJLDBCQUFvQixnQkFBa0MsRUFBVSxHQUFzQjtRQUFsRSxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQVUsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUFEdEYsY0FBUyxHQUFTLFNBQVMsQ0FBQztJQUc1QixDQUFDO0lBRUQsbUNBQVEsR0FBUjtRQUNJLElBQUksQ0FBQyxHQUFHLEdBQUcsbUJBQU0sQ0FBQyxRQUFRLEdBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUMsR0FBRyxHQUFDLG1CQUFNLENBQUMsYUFBYSxHQUFDLHVCQUF1QixDQUFDO1FBRXZILElBQUksUUFBUSxHQUFHLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEQsRUFBRSxDQUFBLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQSxDQUFDO1lBQ3RCLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNsRSxRQUFRLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUM7WUFDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2xELENBQUM7SUFFTCxDQUFDO0lBQ0QsMENBQWUsR0FBZjtRQUFBLGlCQU1DO1FBSkcsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDOUIsTUFBTSxDQUFFLE1BQU0sQ0FBRSxDQUFDLE1BQU0sQ0FBQztZQUNwQixLQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxpREFBc0IsR0FBdEI7UUFDSSxJQUFJLEtBQUssR0FBRyxNQUFNLENBQUUsTUFBTSxDQUFFLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDckMsRUFBRSxDQUFBLENBQUUsS0FBSyxHQUFDLEdBQUksQ0FBQztZQUNYLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDL0IsSUFBSSxDQUFDLEVBQUUsQ0FBQSxDQUFFLEtBQUssSUFBRSxHQUFHLElBQUksS0FBSyxHQUFDLEdBQUksQ0FBQztZQUM5QixJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzlCLElBQUk7WUFDQSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzlCLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVELHVDQUFZLEdBQVo7UUFDSSxFQUFFLENBQUEsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFHLFFBQVEsQ0FBQztZQUN6QixNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUVELHVDQUFZLEdBQVo7UUFDSSxFQUFFLENBQUEsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFHLFFBQVEsQ0FBQztZQUN6QixNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVELHFDQUFVLEdBQVYsVUFBVyxTQUFpQjtRQUN4QixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDaEIsSUFBSSxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2pCLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQy9CLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRixDQUFDO0lBdEREO1FBQUMsWUFBSyxFQUFFOztrREFBQTtJQS9HWjtRQUFDLGdCQUFTLENBQUM7WUFDWCxRQUFRLEVBQUUsWUFBWTtZQUN0QixVQUFVLEVBQUUsRUFBRTtZQUNkLFNBQVMsRUFBQyxFQUFFO1lBQ1osS0FBSyxFQUFDLENBQUMsZUFBTyxDQUFDO1lBQ2YsUUFBUSxFQUFHLHVyQ0F3QkE7WUFDWCxNQUFNLEVBQUMsQ0FBQyxpaURBNkVQLENBQUM7U0FDRCxDQUFDOzt3QkFBQTtJQTBERix1QkFBQztBQUFELENBeERBLEFBd0RDLElBQUE7QUF4RFksd0JBQWdCLG1CQXdENUIsQ0FBQSIsImZpbGUiOiJhcHAvc2l0ZS90ZW1wbGF0ZXMvdGVtcGxhdGVBbGwvcHJldmlldy5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCxBZnRlclZpZXdJbml0LCBJbnB1dCwgQ2hhbmdlRGV0ZWN0b3JSZWZ9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJEb21haW5TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2hhcmVkL3NlcnZpY2VzL2luZGV4JztcclxuaW1wb3J0IHsgU2FmZVVybCB9IGZyb20gJy4uL3BpcGVzL2luZGV4JztcclxuaW1wb3J0IHsgQ29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vY29uZmlnL2Vudi5jb25maWcnO1xyXG5cclxuZGVjbGFyZSB2YXIgalF1ZXJ5OiBhbnk7XHJcbmRlY2xhcmUgdmFyIHdpbmRvdzogYW55O1xyXG5kZWNsYXJlIHZhciBkb2N1bWVudDogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbnNlbGVjdG9yIDonb2ctcHJldmlldycsXHJcbmRpcmVjdGl2ZXM6IFtdLFxyXG5wcm92aWRlcnM6W10sXHJcbnBpcGVzOltTYWZlVXJsXSxcclxudGVtcGxhdGUgOiBgXHJcbiAgICA8ZGl2IGNsYXNzPVwicmVzcG9uc2l2ZS1tZW51XCIgKG1vdXNlZW50ZXIpPVwib25Nb3VzZUVudGVyKClcIj5cclxuICAgICAgICA8c3BhbiBjbGFzcz1cInRpdGxlXCI+UmVzaXplIFRlbXBsYXRlOiA8L3NwYW4+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImljb24tYmxvY2tcIj5cclxuICAgICAgICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiAoY2xpY2spPVwic3dpdGNoVmlldygnZGVza3RvcCcpXCIgW2NsYXNzLmFjdGl2ZS12aWV3XSA9IFwiY2xhc3NOYW1lPT09J2Rlc2t0b3AnXCI+XHJcbiAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+ZGVza3RvcF9tYWM8L2k+IDxzcGFuPnw8L3NwYW4+PC9hPlxyXG4gICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIChjbGljayk9XCJzd2l0Y2hWaWV3KCd0YWJsZXQnKVwiICBbY2xhc3MuYWN0aXZlLXZpZXddID0gXCJjbGFzc05hbWU9PT0ndGFibGV0J1wiPlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPnRhYmxldF9tYWM8L2k+PHNwYW4+fDwvc3Bhbj4gPC9hPlxyXG4gICAgICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIChjbGljayk9XCJzd2l0Y2hWaWV3KCdtb2JpbGUnKVwiICBbY2xhc3MuYWN0aXZlLXZpZXddID0gXCJjbGFzc05hbWU9PT0nbW9iaWxlJ1wiPlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPnNtYXJ0cGhvbmU8L2k+PC9hPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgICA8ZGl2IGlkPVwibWFpbi1wcm9maWxlXCI+XHJcbiAgICAgICAgPGlmcmFtZVxyXG4gICAgICAgIChtb3VzZWVudGVyKT1cIm9uTW91c2VFbnRlcigpXCIgXHJcbiAgICAgICAgKG1vdXNlbGVhdmUpPVwib25Nb3VzZUxlYXZlKClcIlxyXG4gICAgICAgIGlkPVwibW9iaWxlLWlmcmFtZVwiXHJcbiAgICAgICAgW25nQ2xhc3NdPVwie1xyXG4gICAgICAgICAgICBkZXNrdG9wOiBjbGFzc05hbWU9PT0nZGVza3RvcCcsIFxyXG4gICAgICAgICAgICB0YWJsZXQ6IGNsYXNzTmFtZT09PSd0YWJsZXQnLFxyXG4gICAgICAgICAgICBtb2JpbGU6IGNsYXNzTmFtZT09PSdtb2JpbGUnXHJcbiAgICAgICAgfVwiIFxyXG4gICAgICAgIFtzcmNdPVwic3JjIHwgc2FmZVVybFwiIGFsaWduPVwibWlkZGxlXCI+XHJcbiAgICAgICAgPC9pZnJhbWU+XHJcbiAgICA8L2Rpdj5gLFxyXG5zdHlsZXM6W2BcclxuICAgIC5yZXNwb25zaXZlLW1lbnUge1xyXG4gICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC40NSk7XHJcbiAgICAgICAgY29sb3I6ICNmZmY7XHJcbiAgICAgICAgd2lkdGg6IDMyMHB4O1xyXG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICBwYWRkaW5nOiA2cHggNnB4O1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICB6LWluZGV4OiA5OTk7XHJcbiAgICAgICAgbWFyZ2luOiAwIGF1dG87XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87XHJcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xyXG4gICAgICAgIGxlZnQ6IC0zcHg7XHJcbiAgICAgICAgcmlnaHQ6IDA7XHJcbiAgICAgICAgdG9wOiAxMHB4O1xyXG4gICAgICAgIGZvbnQtc2l6ZTogMTNweDtcclxuICAgIH1cclxuXHJcbiAgICAucmVzcG9uc2l2ZS1tZW51IGEge1xyXG4gICAgICAgIGNvbG9yOiAjZmZmO1xyXG4gICAgICAgIHBhZGRpbmc6IDAgNXB4O1xyXG4gICAgICAgICAgICBmbG9hdDogbGVmdDtcclxuICAgIH1cclxuXHJcbiAgICAucmVzcG9uc2l2ZS1tZW51IGEgc3BhbiB7XHJcbiAgICAgICAgbWFyZ2luLXRvcDogLTIwcHg7XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDEzcHg7XHJcbiAgICAgICAgZmxvYXQ6IHJpZ2h0O1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDNweDtcclxuICAgICAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMxKTtcclxuICAgIH1cclxuXHJcbiAgICBpZnJhbWUge1xyXG4gICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87XHJcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xyXG4gICAgICAgIGxlZnQ6IDA7XHJcbiAgICAgICAgcmlnaHQ6IDA7XHJcbiAgICAgICAgdG9wOiAwcHg7XHJcbiAgICAgICAgYm9yZGVyOiBub25lO1xyXG4gICAgfVxyXG4gICAgLmFjdGl2ZS12aWV3IGl7XHJcbiAgICAgICAgY29sb3I6ICNmYjU0NWI7XHJcbiAgICB9XHJcbiAgICAucmVzcG9uc2l2ZS1tZW51IHNwYW4udGl0bGUge1xyXG4gICAgICAgIG1hcmdpbi1yaWdodDogMjZweDtcclxuICAgICAgICBmbG9hdDogbGVmdDtcclxuICAgICAgICBtYXJnaW4tdG9wOiA3cHg7XHJcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDI2cHg7XHJcbiAgICB9XHJcblxyXG4gICAgLnJlc3BvbnNpdmUtbWVudSBkaXYge1xyXG4gICAgICAgIGZsb2F0OiBsZWZ0O1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDRweDtcclxuICAgIH1cclxuXHJcbiAgICAuZGVza3RvcCB7XHJcbiAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgfVxyXG5cclxuICAgIC5tb2JpbGUge1xyXG4gICAgICAgIHdpZHRoOiAzNzVweDtcclxuICAgICAgICBoZWlnaHQ6IDU3MHB4O1xyXG4gICAgICAgIG1hcmdpbjogMSUgYXV0bztcclxuICAgICAgICBoZWlnaHQ6NTcwcHg7XHJcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RjZGRkZjtcclxuICAgIH1cclxuXHJcbiAgICAudGFibGV0IHtcclxuICAgICAgICB3aWR0aDogNzc1cHg7XHJcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICAgIG1hcmdpbjogMCBhdXRvO1xyXG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNkY2RkZGY7XHJcbiAgICB9XHJcbmBdXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgUHJldmlld0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBASW5wdXQoKSBqc29uOiBhbnk7XHJcbiAgICBzcmM6IHN0cmluZztcclxuICAgIGNsYXNzTmFtZTogc3RyaW5nPSdkZXNrdG9wJztcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc3ViRG9tYWluU2VydmljZTogU3ViRG9tYWluU2VydmljZSwgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMuc3JjID0gQ29uZmlnLlBST1RPQ09MK3RoaXMuc3ViRG9tYWluU2VydmljZS5zdWJEb21haW4uc3ViX2RvbWFpbisnLicrQ29uZmlnLkFQUF9FWFRFTlNJT04rJy9wcmV2aWV3L3ByZXZpZXdGcmFtZSc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHRlbXBsYXRlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RlbXBsYXRlJyk7XHJcbiAgICAgICAgaWYodGVtcGxhdGUgfHwgdGhpcy5qc29uKXtcclxuICAgICAgICAgICAgbGV0IGFwcCA9IHRoaXMuanNvbiB8fCBKU09OLnBhcnNlKHRlbXBsYXRlKTtcclxuICAgICAgICAgICAgalF1ZXJ5KCdtZXRhW25hbWU9ZGVzY3JpcHRpb25dJykuYXR0cignY29udGVudCcsIGFwcC5kZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gYXBwLnRpdGxlO1xyXG4gICAgICAgICAgICBqUXVlcnkoJyNmYXZpY29uJykuYXR0cignaHJlZicsICBhcHAuZmF2aWNvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICAvL2NvZGVcclxuICAgICAgICB0aGlzLnZpZXdPbldpbmRvd1dpZHRoQmFzaXMoKTtcclxuICAgICAgICBqUXVlcnkoIHdpbmRvdyApLnJlc2l6ZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmlld09uV2luZG93V2lkdGhCYXNpcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHZpZXdPbldpbmRvd1dpZHRoQmFzaXMoKTogdm9pZHtcclxuICAgICAgICBsZXQgd2lkdGggPSBqUXVlcnkoIHdpbmRvdyApLndpZHRoKCk7XHJcbiAgICAgICAgaWYoIHdpZHRoPjc3NSApXHJcbiAgICAgICAgICAgIHRoaXMuc3dpdGNoVmlldygnZGVza3RvcCcpO1xyXG4gICAgICAgIGVsc2UgaWYoIHdpZHRoPD03NzUgJiYgd2lkdGg+Mzc1IClcclxuICAgICAgICAgICAgdGhpcy5zd2l0Y2hWaWV3KCd0YWJsZXQnKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMuc3dpdGNoVmlldygnbW9iaWxlJyk7XHJcbiAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VFbnRlcigpIHtcclxuICAgICAgICBpZih0aGlzLmNsYXNzTmFtZT09PSdtb2JpbGUnKVxyXG4gICAgICAgICAgICBqUXVlcnkoJy5yZXNwb25zaXZlLW1lbnUnKS5mYWRlSW4oNjAwKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlTGVhdmUoKSB7XHJcbiAgICAgICAgaWYodGhpcy5jbGFzc05hbWU9PT0nbW9iaWxlJylcclxuICAgICAgICAgICAgalF1ZXJ5KCcucmVzcG9uc2l2ZS1tZW51JykuZmFkZU91dCg2MDApO1xyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaFZpZXcoY2xhc3NOYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcclxuICAgICAgICBsZXQgd2lkdGggPSA2MDA7XHJcbiAgICAgICAgbGV0IGhlaWdodCA9IDQwMDtcclxuICAgICAgICB3aW5kb3cucmVzaXplQnkod2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgd2luZG93Lm1vdmVUbygoKHNjcmVlbi53aWR0aCAtIHdpZHRoKSAvIDIpLCAoKHNjcmVlbi5oZWlnaHQgLSBoZWlnaHQpIC8gMikpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==
