"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require('@angular/core');
var common_properties_component_1 = require('../common/common_properties.component');
var model_1 = require('../../../models/model');
var JSONBuilder_service_1 = require('../../../services/JSONBuilder.service');
var selectize_component_1 = require('./component/selectize.component');
var feature_access_service_1 = require('../../../../../shared/services/feature-access.service');
var EditorLeadForm = (function () {
    function EditorLeadForm(jsonBuilderHelper, _featureAuthService) {
        this.jsonBuilderHelper = jsonBuilderHelper;
        this._featureAuthService = _featureAuthService;
        this.isLeadAccessible = false;
        this.types = ["firstName", "email", "tel", "lastName"];
    }
    EditorLeadForm.prototype.ngOnInit = function () {
        this.leadform = this.control.leadform;
        this.isLeadAccessible = this._featureAuthService.features.lead_generation;
        jQuery("#lead_gen_control").stop();
    };
    EditorLeadForm.prototype.toggleRequired = function (field) {
        field.validations.required.status = !field.validations.required.status;
        this.jsonBuilderHelper.setChanged(true);
    };
    EditorLeadForm.prototype.add_Field_In_LeadForm = function () {
        var item = new model_1.Item;
        this.leadform.fields.push(item.getField());
    };
    EditorLeadForm.prototype.toggleLeadform = function (event) {
        if (this.isLeadAccessible) {
            this.leadform.visible = !this.leadform.visible;
            if (this.leadform.visible) {
                this.jsonBuilderHelper.hideOtherLeadForm1();
            }
            this.control.click_button.visible
                ? this.control.leadform.props.title = this.control.click_button.props.title
                : this.control.click_button.props.title = this.control.leadform.props.title;
            if (this.control.click_button)
                this.control.click_button.visible = !this.control.click_button.visible;
        }
        else {
            event.preventDefault();
            jQuery('#premiumModal').modal('show');
            this.leadform.visible = false;
            this.control.click_button.visible = true;
        }
    };
    EditorLeadForm.prototype.delete_Field_From_LeadForm = function (index) {
        this.leadform.fields.splice(index, 1);
    };
    EditorLeadForm.prototype.callGA = function (opt) {
        switch (opt) {
            case "LEADGENTOGGLE":
                if (this.leadform.visible) {
                    ga('markettingteam.send', 'event', 'Settings', 'Toggle', 'LeadGenerationToggleOn');
                    _kmq.push(['record', 'Builder Lead Gen Toggle Set On']);
                }
                else {
                    ga('markettingteam.send', 'event', 'Settings', 'Toggle', 'LeadGenerationToggleOff');
                    _kmq.push(['record', 'Builder Lead Gen Toggle Set Off']);
                }
                break;
            case "DeleteLeadGenField":
                ga('markettingteam.send', 'event', 'Settings', 'Click', 'DeleteLeadGenField');
                _kmq.push(['record', 'Builder Delete Lead Gen Field Click']);
                break;
            case "AddNewLeadField":
                ga('markettingteam.send', 'event', 'Settings', 'Click', 'AddNewLeadField');
                _kmq.push(['record', 'Builder Add New Lead Field Click']);
                break;
            case "SETMANDATE":
                ga('markettingteam.send', 'event', 'Settings', 'Click', 'Set Mandatory');
                _kmq.push(['record', 'Builder Lead Field Set Mandatory Click']);
                break;
            case "UNSETMANDATE":
                ga('markettingteam.send', 'event', 'Settings', 'Click', 'Unset Mandatory');
                _kmq.push(['record', 'Builder Lead Field Unset Mandatory Click']);
                break;
        }
    };
    __decorate([
        core_1.Input(), 
        __metadata('design:type', Object)
    ], EditorLeadForm.prototype, "control", void 0);
    __decorate([
        core_1.Input(), 
        __metadata('design:type', Object)
    ], EditorLeadForm.prototype, "leadsection", void 0);
    EditorLeadForm = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'editor-lead-form',
            directives: [common_properties_component_1.CommonEditor, selectize_component_1.Selectize],
            encapsulation: core_1.ViewEncapsulation.None,
            template: "\n        <div>\n        <div class=\"form-label no-margin\" >Lead Generation:</div>\n        \n        <div class=\"switch\" [class.alwaysOff]=\"!isLeadAccessible\">\n            <label>\n                <input id=\"lead_gen_control\" type=\"checkbox\" class=\"\" (change)=\"toggleLeadform($event);callGA('LEADGENTOGGLE')\" [checked]=\"leadform.visible\">\n                <span class=\"lever\"></span>\n            </label>\n        </div>\n        <div class=\"help-tip editor-helptip\">\n            <i class=\"material-icons\">info_outline</i>\n            <div class=\"help-checktip\">Toggle here to collect user information (name, email etc) along with the \n                <span *ngIf=\"jsonBuilderHelper.getSelectedPage().type!=='Landing'\"> {{jsonBuilderHelper.getSelectedPage().type }}</span>\n                <span *ngIf=\"jsonBuilderHelper.getSelectedPage().type==='Landing'\"> Welcome Screen</span>.</div>\n        </div>\n        </div>\n        <span *ngIf=\"jsonBuilderHelper.getOtherVisibleLeadForm() &&\n                jsonBuilderHelper.getOtherVisibleLeadForm() !==jsonBuilderHelper.getSelectedPage().type\"\n                class=\"editor-helptext no-margin\"\n                style=\"margin-top: 10px;\"> \n                Please note that you are currently collecting leads on the\n                <i> {{ jsonBuilderHelper.getOtherVisibleLeadForm() }} Page</i>. \n                If you wish to collect leads here instead, Toggle here to override.\n         </span>\n        \n    "
        }), 
        __metadata('design:paramtypes', [JSONBuilder_service_1.JSONBuilder, feature_access_service_1.FeatureAuthService])
    ], EditorLeadForm);
    return EditorLeadForm;
}());
exports.EditorLeadForm = EditorLeadForm;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaXRlLytidWlsZGVyL2NvbXBvbmVudHMvZWRpdG9ycy9sZWFkZm9ybS9lZGl0b3JfbGVhZGZvcm0uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxxQkFBNEQsZUFBZSxDQUFDLENBQUE7QUFDNUUsNENBQThCLHVDQUF1QyxDQUFDLENBQUE7QUFDdEUsc0JBQXFCLHVCQUF1QixDQUFDLENBQUE7QUFDN0Msb0NBQTRCLHVDQUF1QyxDQUFDLENBQUE7QUFDcEUsb0NBQTBCLGlDQUFpQyxDQUFDLENBQUE7QUFDNUQsdUNBQWlDLHVEQUF1RCxDQUFDLENBQUE7QUF1RXpGO0lBTUksd0JBQW9CLGlCQUE4QixFQUN0QyxtQkFBdUM7UUFEL0Isc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFhO1FBQ3RDLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBb0I7UUFKbkQscUJBQWdCLEdBQVksS0FBSyxDQUFDO1FBRWxDLFVBQUssR0FBSyxDQUFDLFdBQVcsRUFBQyxPQUFPLEVBQUMsS0FBSyxFQUFDLFVBQVUsQ0FBQyxDQUFDO0lBSWpELENBQUM7SUFFRCxpQ0FBUSxHQUFSO1FBQ0ksSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztRQUN0QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUM7UUFDMUUsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDdkMsQ0FBQztJQUNELHVDQUFjLEdBQWQsVUFBZSxLQUFVO1FBQ3JCLEtBQUssQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQztRQUN2RSxJQUFJLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVDLENBQUM7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cm0vZWRpdG9yX2xlYWRmb3JtLmNvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tbW9uRWRpdG9yICB9IGZyb20gJy4uL2NvbW1vbi9jb21tb25fcHJvcGVydGllcy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBJdGVtIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL21vZGVsJztcclxuaW1wb3J0IHsgSlNPTkJ1aWxkZXIgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9KU09OQnVpbGRlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU2VsZWN0aXplIH0gZnJvbSAnLi9jb21wb25lbnQvc2VsZWN0aXplLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7RmVhdHVyZUF1dGhTZXJ2aWNlfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zaGFyZWQvc2VydmljZXMvZmVhdHVyZS1hY2Nlc3Muc2VydmljZSc7XHJcblxyXG5kZWNsYXJlIHZhciBqUXVlcnk6IGFueTtcclxuZGVjbGFyZSB2YXIgZ2E6IGFueTtcclxuZGVjbGFyZSB2YXIgX2ttcTogYW55O1xyXG5AQ29tcG9uZW50KHtcclxuICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXHJcbiAgICBzZWxlY3RvcjogJ2VkaXRvci1sZWFkLWZvcm0nLFxyXG4gICAgZGlyZWN0aXZlczogW0NvbW1vbkVkaXRvciwgU2VsZWN0aXplXSxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICAgIDxkaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tbGFiZWwgbm8tbWFyZ2luXCIgPkxlYWQgR2VuZXJhdGlvbjo8L2Rpdj5cclxuICAgICAgICBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwic3dpdGNoXCIgW2NsYXNzLmFsd2F5c09mZl09XCIhaXNMZWFkQWNjZXNzaWJsZVwiPlxyXG4gICAgICAgICAgICA8bGFiZWw+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJsZWFkX2dlbl9jb250cm9sXCIgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJcIiAoY2hhbmdlKT1cInRvZ2dsZUxlYWRmb3JtKCRldmVudCk7Y2FsbEdBKCdMRUFER0VOVE9HR0xFJylcIiBbY2hlY2tlZF09XCJsZWFkZm9ybS52aXNpYmxlXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxldmVyXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICA8L2xhYmVsPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJoZWxwLXRpcCBlZGl0b3ItaGVscHRpcFwiPlxyXG4gICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+aW5mb19vdXRsaW5lPC9pPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaGVscC1jaGVja3RpcFwiPlRvZ2dsZSBoZXJlIHRvIGNvbGxlY3QgdXNlciBpbmZvcm1hdGlvbiAobmFtZSwgZW1haWwgZXRjKSBhbG9uZyB3aXRoIHRoZSBcclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwianNvbkJ1aWxkZXJIZWxwZXIuZ2V0U2VsZWN0ZWRQYWdlKCkudHlwZSE9PSdMYW5kaW5nJ1wiPiB7e2pzb25CdWlsZGVySGVscGVyLmdldFNlbGVjdGVkUGFnZSgpLnR5cGUgfX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImpzb25CdWlsZGVySGVscGVyLmdldFNlbGVjdGVkUGFnZSgpLnR5cGU9PT0nTGFuZGluZydcIj4gV2VsY29tZSBTY3JlZW48L3NwYW4+LjwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxzcGFuICpuZ0lmPVwianNvbkJ1aWxkZXJIZWxwZXIuZ2V0T3RoZXJWaXNpYmxlTGVhZEZvcm0oKSAmJlxyXG4gICAgICAgICAgICAgICAganNvbkJ1aWxkZXJIZWxwZXIuZ2V0T3RoZXJWaXNpYmxlTGVhZEZvcm0oKSAhPT1qc29uQnVpbGRlckhlbHBlci5nZXRTZWxlY3RlZFBhZ2UoKS50eXBlXCJcclxuICAgICAgICAgICAgICAgIGNsYXNzPVwiZWRpdG9yLWhlbHB0ZXh0IG5vLW1hcmdpblwiXHJcbiAgICAgICAgICAgICAgICBzdHlsZT1cIm1hcmdpbi10b3A6IDEwcHg7XCI+IFxyXG4gICAgICAgICAgICAgICAgUGxlYXNlIG5vdGUgdGhhdCB5b3UgYXJlIGN1cnJlbnRseSBjb2xsZWN0aW5nIGxlYWRzIG9uIHRoZVxyXG4gICAgICAgICAgICAgICAgPGk+IHt7IGpzb25CdWlsZGVySGVscGVyLmdldE90aGVyVmlzaWJsZUxlYWRGb3JtKCkgfX0gUGFnZTwvaT4uIFxyXG4gICAgICAgICAgICAgICAgSWYgeW91IHdpc2ggdG8gY29sbGVjdCBsZWFkcyBoZXJlIGluc3RlYWQsIFRvZ2dsZSBoZXJlIHRvIG92ZXJyaWRlLlxyXG4gICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgXHJcbiAgICBgXHJcbn0pXHJcbi8vIDxkaXYgKm5nSWY9XCJsZWFkZm9ybS52aXNpYmxlICYmIGpzb25CdWlsZGVySGVscGVyLmdldFNlbGVjdGVkUGFnZSgpLnR5cGUgPT09ICdSZXN1bHQnICYmIGxlYWRzZWN0aW9uXCIgY2xhc3M9XCJjb2wtbWQtMTEgbm8tcGFkZGluZyBsZWFkLWhlYWRcIj5cclxuLy8gXHRcdFx0PHNwYW4gY2xhc3M9XCJmb3JtLWxhYmVsIFwiPkFkZCBIZWFkaW5nPC9zcGFuPlxyXG4vLyBcdFx0XHQ8ZGl2IGNsYXNzPVwiY29sLXhzLTEyIG5vLXBhZGRpbmcgdGV4dC1ncm91cCBkaXYtY2hlY2tcIj5cclxuLy8gXHRcdFx0ICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmb3JtLWNvbnRyb2wgZm9ybS10ZXh0XCIgIFsobmdNb2RlbCldID0gXCJsZWFkc2VjdGlvbi50aXRsZVwiPlxyXG4vLyBcdFx0XHQ8L2Rpdj5cclxuLy8gXHRcdDwvZGl2PlxyXG4vLyA8ZGl2IGNsYXNzPVwiZGl2LWNoZWNrXCIgKm5nSWY9XCJsZWFkZm9ybS52aXNpYmxlXCI+XHJcbi8vICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsZWFkLWdlblwiICpuZ0Zvcj1cImxldCBmaWVsZCBvZiBsZWFkZm9ybS5maWVsZHMgOyBsZXQgaSA9IGluZGV4XCI+XHJcbi8vICAgICAgICAgICAgICAgPHNlbGVjdGl6ZSBbZmllbGRdPVwiZmllbGRcIiBbdHlwZXNdPVwidHlwZXNcIiBbaW5kZXhdID0gXCJpXCI+PC9zZWxlY3RpemU+XHJcblxyXG4vLyAgICAgICAgICAgICAgIDwhLS0gTW9yZSBidXR0b24gLS0+XHJcbi8vICAgICAgICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBpY29uLW9wdGlvbnNcIj5cclxuLy8gICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgZHJvcGRvd24tdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCIgYXJpYS1leHBhbmRlZD1cImZhbHNlXCI+XHJcbi8vICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAxMnB4O1wiPm1vcmVfdmVydDwvaT5cclxuLy8gICAgICAgICAgICAgPC9idXR0b24+XHJcbi8vICAgICAgICAgICAgIDx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIj5cclxuLy8gICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiICpuZ0lmID0gXCIhZmllbGQudmFsaWRhdGlvbnMucmVxdWlyZWQuc3RhdHVzXCIgKGNsaWNrKT1cInRvZ2dsZVJlcXVpcmVkKGZpZWxkKTtjYWxsR0EoJ1NFVE1BTkRBVEUnKVwiPlxyXG4vLyAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5kb25lX2FsbDwvaT4gTWFrZSBNYW5kYXRvcnk8L2E+PC9saT5cclxuLy8gICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiICpuZ0lmID0gXCJmaWVsZC52YWxpZGF0aW9ucy5yZXF1aXJlZC5zdGF0dXNcIiAoY2xpY2spPVwidG9nZ2xlUmVxdWlyZWQoZmllbGQpO2NhbGxHQSgnVU5TRVRNQU5EQVRFJylcIj5cclxuLy8gICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+bm90X2ludGVyZXN0ZWQ8L2k+IE5vdCBNYW5kYXRvcnk8L2E+PC9saT5cclxuLy8gICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIGNsYXNzPVwiZm9ybS1sZWFkZm9ybS1pY29uXCJcclxuLy8gICAgICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cImRlbGV0ZV9GaWVsZF9Gcm9tX0xlYWRGb3JtKGkpO2NhbGxHQSgnRGVsZXRlTGVhZEdlbkZpZWxkJylcIj5cclxuLy8gICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmNsZWFyPC9pPiBEZWxldGU8L2E+PC9saT5cclxuLy8gICAgICAgICAgICAgPC91bD5cclxuLy8gICAgICAgICA8L2Rpdj5cclxuLy8gICAgICAgICAgICAgPC9kaXY+XHJcbi8vICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtMTEgbm8tcGFkZGluZyBwdWxsLXJpZ2h0XCIgW2NsYXNzLmhpZGVdPVwibGVhZGZvcm0uZmllbGRzLmxlbmd0aD49NFwiPlxyXG4vLyAgICAgICAgICAgICAgICAgPGEgIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCIgKGNsaWNrKT1cImFkZF9GaWVsZF9Jbl9MZWFkRm9ybSgpO2NhbGxHQSgnQWRkTmV3TGVhZEZpZWxkJylcIlxyXG4vLyAgICAgICAgICAgICAgICAgY2xhc3M9XCJkZWZhdWx0IGFkZF9maWVsZF9idXR0b25cIj5BZGQgYSBmaWVsZFxyXG4vLyAgICAgICAgICAgICAgICAgPC9hPlxyXG4vLyAgICAgICAgICAgICA8L2Rpdj5cclxuLy8gICAgICAgICA8L2Rpdj5cclxuXHJcbmV4cG9ydCBjbGFzcyBFZGl0b3JMZWFkRm9ybSBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSBjb250cm9sOiBhbnk7XHJcbiAgICBASW5wdXQoKSBsZWFkc2VjdGlvbjphbnk7XHJcbiAgICBpc0xlYWRBY2Nlc3NpYmxlOiBCb29sZWFuID0gZmFsc2U7XHJcbiAgICBsZWFkZm9ybTogYW55O1xyXG4gICAgdHlwZXM6YW55PVtcImZpcnN0TmFtZVwiLFwiZW1haWxcIixcInRlbFwiLFwibGFzdE5hbWVcIl07XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGpzb25CdWlsZGVySGVscGVyOiBKU09OQnVpbGRlcixcclxuICAgICAgICBwcml2YXRlIF9mZWF0dXJlQXV0aFNlcnZpY2U6IEZlYXR1cmVBdXRoU2VydmljZSkge1xyXG4gICAgICAgIC8vIHRoaXMubGVhZGZvcm0gPSBqc29uQnVpbGRlckhlbHBlci5nZXRTZWxlY3RlZGxlYWRmb3JtKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5sZWFkZm9ybSA9IHRoaXMuY29udHJvbC5sZWFkZm9ybTtcclxuICAgICAgICB0aGlzLmlzTGVhZEFjY2Vzc2libGUgPSB0aGlzLl9mZWF0dXJlQXV0aFNlcnZpY2UuZmVhdHVyZXMubGVhZF9nZW5lcmF0aW9uO1xyXG4gICAgICAgIGpRdWVyeShcIiNsZWFkX2dlbl9jb250cm9sXCIpLnN0b3AoKTtcclxuICAgIH1cclxuICAgIHRvZ2dsZVJlcXVpcmVkKGZpZWxkOiBhbnkpIHtcclxuICAgICAgICBmaWVsZC52YWxpZGF0aW9ucy5yZXF1aXJlZC5zdGF0dXMgPSAhZmllbGQudmFsaWRhdGlvbnMucmVxdWlyZWQuc3RhdHVzO1xyXG4gICAgICAgIHRoaXMuanNvbkJ1aWxkZXJIZWxwZXIuc2V0Q2hhbmdlZCh0cnVlKTtcclxuICAgIH1cclxuICAgIGFkZF9GaWVsZF9Jbl9MZWFkRm9ybSgpIHtcclxuICAgICAgICBsZXQgaXRlbSA9IG5ldyBJdGVtO1xyXG4gICAgICAgIHRoaXMubGVhZGZvcm0uZmllbGRzLnB1c2goaXRlbS5nZXRGaWVsZCgpKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVMZWFkZm9ybShldmVudDogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNMZWFkQWNjZXNzaWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxlYWRmb3JtLnZpc2libGUgPSAhdGhpcy5sZWFkZm9ybS52aXNpYmxlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5sZWFkZm9ybS52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmpzb25CdWlsZGVySGVscGVyLmhpZGVPdGhlckxlYWRGb3JtMSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbC5jbGlja19idXR0b24udmlzaWJsZVxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmNvbnRyb2wubGVhZGZvcm0ucHJvcHMudGl0bGUgPSB0aGlzLmNvbnRyb2wuY2xpY2tfYnV0dG9uLnByb3BzLnRpdGxlXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMuY29udHJvbC5jbGlja19idXR0b24ucHJvcHMudGl0bGUgPSB0aGlzLmNvbnRyb2wubGVhZGZvcm0ucHJvcHMudGl0bGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2wuY2xpY2tfYnV0dG9uKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250cm9sLmNsaWNrX2J1dHRvbi52aXNpYmxlID0gIXRoaXMuY29udHJvbC5jbGlja19idXR0b24udmlzaWJsZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBqUXVlcnkoJyNwcmVtaXVtTW9kYWwnKS5tb2RhbCgnc2hvdycpO1xyXG4gICAgICAgICAgICB0aGlzLmxlYWRmb3JtLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jb250cm9sLmNsaWNrX2J1dHRvbi52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlX0ZpZWxkX0Zyb21fTGVhZEZvcm0oaW5kZXg6IGFueSkge1xyXG4gICAgICAgIHRoaXMubGVhZGZvcm0uZmllbGRzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FsbEdBKG9wdDogc3RyaW5nKSB7XHJcbiAgICAgICAgc3dpdGNoIChvcHQpIHtcclxuICAgICAgICAgICAgY2FzZSBcIkxFQURHRU5UT0dHTEVcIjpcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlYWRmb3JtLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBnYSgnbWFya2V0dGluZ3RlYW0uc2VuZCcsICdldmVudCcsICdTZXR0aW5ncycsICdUb2dnbGUnLCAnTGVhZEdlbmVyYXRpb25Ub2dnbGVPbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIF9rbXEucHVzaChbJ3JlY29yZCcsICdCdWlsZGVyIExlYWQgR2VuIFRvZ2dsZSBTZXQgT24nXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBnYSgnbWFya2V0dGluZ3RlYW0uc2VuZCcsICdldmVudCcsICdTZXR0aW5ncycsICdUb2dnbGUnLCAnTGVhZEdlbmVyYXRpb25Ub2dnbGVPZmYnKTtcclxuICAgICAgICAgICAgICAgICAgICBfa21xLnB1c2goWydyZWNvcmQnLCAnQnVpbGRlciBMZWFkIEdlbiBUb2dnbGUgU2V0IE9mZiddKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiRGVsZXRlTGVhZEdlbkZpZWxkXCI6XHJcbiAgICAgICAgICAgICAgICBnYSgnbWFya2V0dGluZ3RlYW0uc2VuZCcsICdldmVudCcsICdTZXR0aW5ncycsICdDbGljaycsICdEZWxldGVMZWFkR2VuRmllbGQnKTtcclxuICAgICAgICAgICAgICAgIF9rbXEucHVzaChbJ3JlY29yZCcsICdCdWlsZGVyIERlbGV0ZSBMZWFkIEdlbiBGaWVsZCBDbGljayddKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiQWRkTmV3TGVhZEZpZWxkXCI6XHJcbiAgICAgICAgICAgICAgICBnYSgnbWFya2V0dGluZ3RlYW0uc2VuZCcsICdldmVudCcsICdTZXR0aW5ncycsICdDbGljaycsICdBZGROZXdMZWFkRmllbGQnKTtcclxuICAgICAgICAgICAgICAgIF9rbXEucHVzaChbJ3JlY29yZCcsICdCdWlsZGVyIEFkZCBOZXcgTGVhZCBGaWVsZCBDbGljayddKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiU0VUTUFOREFURVwiOlxyXG4gICAgICAgICAgICAgICAgZ2EoJ21hcmtldHRpbmd0ZWFtLnNlbmQnLCAnZXZlbnQnLCAnU2V0dGluZ3MnLCAnQ2xpY2snLCAnU2V0IE1hbmRhdG9yeScpO1xyXG4gICAgICAgICAgICAgICAgX2ttcS5wdXNoKFsncmVjb3JkJywgJ0J1aWxkZXIgTGVhZCBGaWVsZCBTZXQgTWFuZGF0b3J5IENsaWNrJ10pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJVTlNFVE1BTkRBVEVcIjpcclxuICAgICAgICAgICAgICAgIGdhKCdtYXJrZXR0aW5ndGVhbS5zZW5kJywgJ2V2ZW50JywgJ1NldHRpbmdzJywgJ0NsaWNrJywgJ1Vuc2V0IE1hbmRhdG9yeScpO1xyXG4gICAgICAgICAgICAgICAgX2ttcS5wdXNoKFsncmVjb3JkJywgJ0J1aWxkZXIgTGVhZCBGaWVsZCBVbnNldCBNYW5kYXRvcnkgQ2xpY2snXSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19
